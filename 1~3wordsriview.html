<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•œêµ­ì–´ ì–´íœ˜ ë³µìŠµ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" xintegrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoVBL5gI9kqaFNojp2uaWAEzACmaQg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        .btn {
            transition: all 0.2s ease-in-out;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .btn-answer:disabled {
            cursor: not-allowed;
        }
        .correct {
            background-color: #22c55e !important; /* green-500 */
            color: white !important;
            border-color: #16a34a !important; /* green-600 */
        }
        .incorrect {
            background-color: #ef4444 !important; /* red-500 */
            color: white !important;
            border-color: #dc2626 !important; /* red-600 */
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">
    <div id="app" class="w-full max-w-2xl mx-auto bg-white rounded-2xl shadow-xl p-6 md:p-10 transition-all duration-500">
        
        <!-- ì‹œì‘ í™”ë©´ -->
        <div id="start-screen" class="text-center">
            <h1 class="text-4xl font-bold text-gray-800 mb-4">í•œêµ­ì–´ ì–´íœ˜ ë³µìŠµ</h1>
            <p class="text-lg text-gray-600 mb-8">1ê³¼ë¶€í„° 3ê³¼ê¹Œì§€ì˜ ì–´íœ˜ë¥¼ ë³µìŠµí•´ ë´…ì‹œë‹¤.<br>ì´ 3ë‹¨ê³„ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>
            <div class="space-y-4">
                <button onclick="startQuiz(true)" class="btn w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-4 px-10 rounded-lg text-xl">
                    ìƒˆë¡œ ì‹œì‘í•˜ê¸°
                </button>
                <button id="continue-button" onclick="startQuiz(false)" class="btn w-full bg-green-500 hover:bg-green-600 text-white font-bold py-4 px-10 rounded-lg text-xl hidden">
                    ì´ì–´í•˜ê¸°
                </button>
                 <button id="reset-button" onclick="resetProgress()" class="text-sm text-gray-500 hover:text-red-500 transition-colors mt-2 hidden">
                    í•™ìŠµ ê¸°ë¡ ì´ˆê¸°í™”
                </button>
            </div>
        </div>

        <!-- í€´ì¦ˆ í™”ë©´ -->
        <div id="quiz-screen" class="hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 id="stage-title" class="text-2xl font-bold text-blue-600"></h2>
                <div id="progress-text" class="text-lg font-semibold text-gray-700"></div>
            </div>
            
            <div class="bg-gray-50 border-2 border-gray-200 rounded-lg p-6 mb-6 min-h-[100px] flex items-center justify-center">
                <p id="question-text" class="text-xl md:text-2xl font-medium text-gray-800 leading-relaxed text-center"></p>
            </div>

            <div id="options-container" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <!-- ì„ íƒì§€ ë²„íŠ¼ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤. -->
            </div>

            <div id="feedback-container" class="text-center min-h-[80px] flex items-center justify-center flex-col">
                 <p id="feedback-text" class="text-xl font-bold mb-4"></p>
                 <button id="next-question-button" onclick="nextStep()" class="btn hidden w-full md:w-auto bg-gray-800 hover:bg-gray-900 text-white font-bold py-3 px-8 rounded-lg">
                    ë‹¤ìŒ ë¬¸ì œë¡œ
                </button>
            </div>
        </div>

        <!-- ê²°ê³¼ í™”ë©´ -->
        <div id="result-screen" class="hidden text-center">
             <h2 id="result-title" class="text-3xl font-bold text-gray-800 mb-4"></h2>
            <div id="final-score-text" class="text-5xl font-bold text-blue-600 my-8"></div>
            <p id="result-message" class="text-lg text-gray-600 mb-10"></p>
            <div id="result-buttons" class="space-y-4">
                <button id="next-stage-button" onclick="nextStage()" class="btn w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-8 rounded-lg text-lg">
                    ë‹¤ìŒ ë‹¨ê³„ë¡œ
                </button>
                <button id="restart-button" onclick="restartQuiz()" class="btn w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-8 rounded-lg text-lg">
                    ì²˜ìŒë¶€í„° ë‹¤ì‹œí•˜ê¸°
                </button>
                <button id="capture-button" onclick="captureResult()" class="btn w-full bg-teal-500 hover:bg-teal-600 text-white font-bold py-3 px-8 rounded-lg text-lg">
                    ê²°ê³¼ ìº¡ì³í•˜ê¸°
                </button>
            </div>
        </div>
    </div>

    <script>
        const quizData = [
            // ... (ê¸°ì¡´ quizDataëŠ” ë³€ê²½ ì—†ì´ ê·¸ëŒ€ë¡œ ìœ ì§€ë©ë‹ˆë‹¤) ...
            // 1ë‹¨ê³„: 1ê³¼ ì–´íœ˜
            { stage: 1, question: "ì €ëŠ” ì†ìœ¼ë¡œ ë¬´ì–¸ê°€ë¥¼ ì˜ ë§Œë“¤ì–´ìš”. (      )ê°€ ì¢‹ì€ í¸ì´ì—ìš”.", options: ["ì†ì¬ì£¼ê°€ ì¢‹ë‹¤", "ì„¤ë“ë ¥ì´ ìˆë‹¤", "ì´í•´ê°€ ë¹ ë¥´ë‹¤", "ì±…ì„ê°ì´ ê°•í•˜ë‹¤"], answer: "ì†ì¬ì£¼ê°€ ì¢‹ë‹¤" },
            { stage: 1, question: "ë‹¤ë¥¸ ì‚¬ëŒì˜ ë§ˆìŒì„ ì›€ì§ì´ëŠ” í˜ì´ ìˆëŠ” ì‚¬ëŒì€ (      )ê³  í•  ìˆ˜ ìˆì–´ìš”.", options: ["ì„¤ë“ë ¥ì´ ìˆë‹¤", "ì†Œì§ˆì´ ìˆë‹¤", "ì ì„±ì— ë§ë‹¤", "ì „ê³µì„ ì‚´ë¦¬ë‹¤"], answer: "ì„¤ë“ë ¥ì´ ìˆë‹¤" },
            { stage: 1, question: "ë§¡ì€ ì¼ì€ ëê¹Œì§€ í•´ë‚´ëŠ” ì‚¬ëŒì€ (      )ê³  í•  ìˆ˜ ìˆì–´ìš”.", options: ["ì±…ì„ê°ì´ ê°•í•˜ë‹¤", "ì‚¬êµì ì´ë‹¤", "ê¸ì •ì ì´ë‹¤", "ì ê·¹ì ì´ë‹¤"], answer: "ì±…ì„ê°ì´ ê°•í•˜ë‹¤" },
            { stage: 1, question: "ë¯¸ìˆ ì´ë‚˜ ìŒì•…ì²˜ëŸ¼ ì•„ë¦„ë‹¤ì›€ì„ í‘œí˜„í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•˜ëŠ” ì„±ê²©ì€ (      )ì´ë¼ê³  í•´ìš”.", options: ["ì˜ˆìˆ ì ", "ì‹¤ìš©ì ", "ì‚¬êµì ", "ì ê·¹ì "], answer: "ì˜ˆìˆ ì " },
            { stage: 1, question: "ì–´ë–¤ ì¼ì´ ìì‹ ì—ê²Œ ì˜ ë§ê³  ì¦ê²ê²Œ í•  ìˆ˜ ìˆì„ ë•Œ '(      )'ê³  ë§í•´ìš”.", options: ["ì ì„±ì— ë§ë‹¤", "ì§„ë¡œë¥¼ ì •í•˜ë‹¤", "ì „ê³µì„ ì‚´ë¦¬ë‹¤", "ì¡°ì–¸í•˜ë‹¤"], answer: "ì ì„±ì— ë§ë‹¤" },
            { stage: 1, question: "ì‚¬ëŒë“¤ê³¼ ì–´ìš¸ë¦¬ëŠ” ê²ƒì„ ì¢‹ì•„í•˜ê³  ì¹œêµ¬ê°€ ë§ì€ ì„±ê²©ì€ (      )ì¸ ì„±ê²©ì´ì—ìš”.", options: ["ì‚¬êµì ", "ì˜ˆìˆ ì ", "ì‹¤ìš©ì ", "ê¸ì •ì "], answer: "ì‚¬êµì " },
            // 2ë‹¨ê³„: 2ê³¼ ì–´íœ˜
            { stage: 2, question: "ê½ƒê°€ë£¨ ì•Œë ˆë¥´ê¸° ë•Œë¬¸ì— ëˆˆê³¼ ì½”ê°€ ë„ˆë¬´ (      ).", options: ["ê°€ë µë‹¤", "ì“°ë¦¬ë‹¤", "ì €ë¦¬ë‹¤", "ë»£ë»£í•˜ë‹¤"], answer: "ê°€ë µë‹¤" },
            { stage: 2, question: "ê±±ì •ì´ ë§ì•„ì„œ ê·¸ëŸ°ì§€ (      )ê³  ìˆ¨ì‰¬ê¸° í˜ë“¤ì–´ìš”.", options: ["ê°€ìŠ´ì´ ë‹µë‹µí•˜ë‹¤", "ëª©ì´ ë”°ë”ê±°ë¦¬ë‹¤", "ì†ì´ ê±°ë¶í•˜ë‹¤", "ëˆˆì´ ì¹¨ì¹¨í•˜ë‹¤"], answer: "ê°€ìŠ´ì´ ë‹µë‹µí•˜ë‹¤" },
            { stage: 2, question: "ë„ˆë¬´ ë§ì´ ë¨¹ì–´ì„œ (      ) ì†Œí™”ê°€ ì˜ ì•ˆ ë¼ìš”.", options: ["ê³¼ì‹í•´ì„œ", "ê³¼ë¡œí•´ì„œ", "ê³¼ìŒí•´ì„œ", "ê³¼ì†í•´ì„œ"], answer: "ê³¼ì‹í•´ì„œ" },
            { stage: 2, question: "ì˜¤ë«ë™ì•ˆ ê°™ì€ ìì„¸ë¡œ ì•‰ì•„ ìˆì—ˆë”ë‹ˆ ë‹¤ë¦¬ê°€ (      ).", options: ["ì €ë¦¬ë‹¤", "ë¶“ë‹¤", "ë§‰íˆë‹¤", "ì“°ë¦¬ë‹¤"], answer: "ì €ë¦¬ë‹¤" },
            { stage: 2, question: "ê°ê¸°ì— ê±¸ë ¤ì„œ ê·¸ëŸ°ì§€ (      )ê³  ì•„íŒŒìš”.", options: ["ëª©ì´ ë”°ë”ê±°ë¦¬ë‹¤", "ëˆˆì´ ì¹¨ì¹¨í•˜ë‹¤", "ê°€ìŠ´ì´ ë‹µë‹µí•˜ë‹¤", "ì†ì´ ê±°ë¶í•˜ë‹¤"], answer: "ëª©ì´ ë”°ë”ê±°ë¦¬ë‹¤" },
            { stage: 2, question: "ë„˜ì–´ì ¸ì„œ ë°œëª©ì„ ë‹¤ì³¤ì„ ë•Œ, ì°¨ê°‘ê²Œ (      )ì„/ë¥¼ í•˜ë©´ ë¶“ê¸°ë¥¼ ê°€ë¼ì•‰í ìˆ˜ ìˆì–´ìš”.", options: ["ì–¼ìŒì°œì§ˆ", "ë¯¼ê°„ìš”ë²•", "ì¹¨ì„ ë†“ë‹¤", "ê¹ìŠ¤ë¥¼ í•˜ë‹¤"], answer: "ì–¼ìŒì°œì§ˆ" },
            { stage: 2, question: "ì–´ì œ íšŒì‹ì—ì„œ ìˆ ì„ ë„ˆë¬´ ë§ì´ ë§ˆì…¨ì–´ìš”. (      ) ë•Œë¬¸ì— ë¨¸ë¦¬ê°€ ì•„íŒŒìš”.", options: ["ê³¼ìŒ", "ê³¼ì‹", "ê³¼ì†Œë¹„", "ê³¼ë¡œ"], answer: "ê³¼ìŒ" },
            // 3ë‹¨ê³„: 3ê³¼ ì–´íœ˜
            { stage: 3, question: "ê²½ê¸° ê·œì¹™ì„ ì–´ê¸°ëŠ” í–‰ë™ì„ (      )ì´ë¼ê³  í•´ìš”.", options: ["ë°˜ì¹™", "ë“ì ", "ì—°ì¥ì „", "ìŠ¹ë¶€"], answer: "ë°˜ì¹™" },
            { stage: 3, question: "ìš°ë¦¬ íŒ€ì´ ì—´ì‹¬íˆ ë…¸ë ¥í•´ì„œ ë“œë””ì–´ (      )ì— ì§„ì¶œí–ˆì–´ìš”.", options: ["ê²°ìŠ¹ì „", "ìƒëŒ€í¸", "ê²½ê¸° ì¢…ëª©", "ìƒí’ˆ"], answer: "ê²°ìŠ¹ì „" },
            { stage: 3, question: "ë‘ íŒ€ì˜ ì‹¤ë ¥ì´ ë¹„ìŠ·í•´ì„œ ëˆ„ê°€ ì´ê¸¸ì§€ ëª¨ë¥´ëŠ” ìƒí™©ì„ (      )ë¼ê³  í•´ìš”.", options: ["ë§‰ìƒë§‰í•˜ì´ë‹¤", "ìì‹ ë§Œë§Œí•˜ë‹¤", "ì •ì •ë‹¹ë‹¹í•˜ë‹¤", "í¥ë¯¸ì§„ì§„í•˜ë‹¤"], answer: "ë§‰ìƒë§‰í•˜ì´ë‹¤" },
            { stage: 3, question: "ê²½ê¸°ì—ì„œ ì´ê¸°ê³  ì§€ëŠ” ê²ƒë³´ë‹¤ ì†ì„ìˆ˜ ì—†ì´ ê¹¨ë—í•˜ê²Œ ê²½ìŸí•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•´ìš”. (      )ê²Œ ì‹¸ì›Œì•¼ í•´ìš”.", options: ["ì •ì •ë‹¹ë‹¹í•˜", "ì•„ìŠ¬ì•„ìŠ¬í•˜", "ìì‹ ë§Œë§Œí•˜", "í¥ë¯¸ì§„ì§„í•˜"], answer: "ì •ì •ë‹¹ë‹¹í•˜" },
            { stage: 3, question: "ê²½ê¸° ì¢…ë£Œ ì§ì „ì— ê³¨ì„ ë„£ì–´ ê±°ì˜ ì§ˆ ë»”í•œ ê²½ê¸°ë¥¼ ì´ê²¼ì–´ìš”. ì •ë§ (      )!", options: ["ì•„ìŠ¬ì•„ìŠ¬í–ˆì–´ìš”", "ë§‰ìƒë§‰í•˜ì´ì—ˆì–´ìš”", "í‡´ì¥ë‹¹í–ˆì–´ìš”", "ë¶€ìƒë‹¹í–ˆì–´ìš”"], answer: "ì•„ìŠ¬ì•„ìŠ¬í–ˆì–´ìš”" },
            { stage: 3, question: "ê²½ê¸° ë‚´ë‚´ ì´ê¸°ê³  ìˆë‹¤ê°€ ë§ˆì§€ë§‰ì— ì—­ì „ì„ ë‹¹í•´ì„œ ì¡Œì–´ìš”. (      ).", options: ["ì—­ì „íŒ¨í–ˆì–´ìš”", "ë“ì í–ˆì–´ìš”", "ì§„ì¶œí–ˆì–´ìš”", "ì‘ì›í–ˆì–´ìš”"], answer: "ì—­ì „íŒ¨í–ˆì–´ìš”" },
            { stage: 3, question: "ì¶•êµ¬ ê²½ê¸°ì—ì„œ ê·œì¹™ì„ ì‹¬í•˜ê²Œ ì–´ê²¨ì„œ ì„ ìˆ˜ê°€ (      ).", options: ["í‡´ì¥ë‹¹í–ˆë‹¤", "ë“ì í–ˆë‹¤", "ì—°ì¥ì „ì„ í–ˆë‹¤", "ìŠ¹ë¦¬í–ˆë‹¤"], answer: "í‡´ì¥ë‹¹í–ˆë‹¤" }
        ];

        let currentStage = 1;
        let stageQuestions = [];
        let currentQuestionIndex = 0;
        let stageScore = 0;
        let totalScore = 0;
        const totalStages = 3;

        const ui = {
            startScreen: document.getElementById('start-screen'),
            quizScreen: document.getElementById('quiz-screen'),
            resultScreen: document.getElementById('result-screen'),
            continueButton: document.getElementById('continue-button'),
            resetButton: document.getElementById('reset-button'),
            stageTitle: document.getElementById('stage-title'),
            progressText: document.getElementById('progress-text'),
            questionText: document.getElementById('question-text'),
            optionsContainer: document.getElementById('options-container'),
            feedbackText: document.getElementById('feedback-text'),
            nextQuestionButton: document.getElementById('next-question-button'),
            resultTitle: document.getElementById('result-title'),
            finalScoreText: document.getElementById('final-score-text'),
            resultMessage: document.getElementById('result-message'),
            nextStageButton: document.getElementById('next-stage-button'),
            restartButton: document.getElementById('restart-button'),
            captureButton: document.getElementById('capture-button')
        };

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }
        
        function saveProgress() {
            const progress = { currentStage, totalScore };
            localStorage.setItem('koreanVocabProgress', JSON.stringify(progress));
        }

        function loadProgress() {
            const savedProgress = localStorage.getItem('koreanVocabProgress');
            if (savedProgress) {
                const progress = JSON.parse(savedProgress);
                // ë§ˆì§€ë§‰ ë‹¨ê³„ê¹Œì§€ ì™„ë£Œí–ˆìœ¼ë©´ ì´ì–´í•˜ê¸°ë¥¼ ë³´ì—¬ì£¼ì§€ ì•ŠìŒ
                if (progress.currentStage <= totalStages) {
                    ui.continueButton.classList.remove('hidden');
                    ui.resetButton.classList.remove('hidden');
                    return progress;
                }
            }
            return null;
        }

        function resetProgress() {
            localStorage.removeItem('koreanVocabProgress');
            ui.continueButton.classList.add('hidden');
            ui.resetButton.classList.add('hidden');
        }

        window.onload = loadProgress;

        function startQuiz(fromBeginning) {
            if (fromBeginning) {
                currentStage = 1;
                totalScore = 0;
                resetProgress();
            } else {
                const progress = loadProgress();
                if (progress) {
                    currentStage = progress.currentStage;
                    totalScore = progress.totalScore;
                }
            }
            
            ui.startScreen.classList.add('hidden');
            ui.quizScreen.classList.remove('hidden');
            ui.resultScreen.classList.add('hidden');
            loadStage();
        }

        function loadStage() {
            stageQuestions = quizData.filter(q => q.stage === currentStage);
            currentQuestionIndex = 0;
            stageScore = 0;
            ui.stageTitle.textContent = `${currentStage}ë‹¨ê³„: ì–´íœ˜ ë³µìŠµ`;
            showQuestion();
        }

        function showQuestion() {
            ui.feedbackText.textContent = '';
            ui.nextQuestionButton.classList.add('hidden');

            if (currentQuestionIndex < stageQuestions.length) {
                const question = stageQuestions[currentQuestionIndex];
                ui.questionText.textContent = question.question;
                ui.progressText.textContent = `${currentQuestionIndex + 1} / ${stageQuestions.length}`;
                
                ui.optionsContainer.innerHTML = '';
                const shuffledOptions = [...question.options];
                shuffleArray(shuffledOptions);

                shuffledOptions.forEach(option => {
                    const button = document.createElement('button');
                    button.textContent = option;
                    button.className = "btn btn-answer w-full text-left p-4 rounded-lg border-2 border-gray-300 bg-white text-gray-700 font-medium text-lg";
                    button.onclick = () => selectAnswer(option, question.answer);
                    ui.optionsContainer.appendChild(button);
                });
            }
        }

        function selectAnswer(selectedOption, correctAnswer) {
            const allOptions = ui.optionsContainer.querySelectorAll('button');
            allOptions.forEach(btn => {
                btn.disabled = true;
                if (btn.textContent === correctAnswer) {
                    btn.classList.add('correct');
                } else if (btn.textContent === selectedOption) {
                    btn.classList.add('incorrect');
                }
            });

            if (selectedOption === correctAnswer) {
                stageScore++;
                totalScore++;
                ui.feedbackText.textContent = "ì •ë‹µì…ë‹ˆë‹¤! ğŸ‰";
                ui.feedbackText.style.color = '#22c55e';
            } else {
                ui.feedbackText.textContent = `í‹€ë ¸ìŠµë‹ˆë‹¤. ì •ë‹µì€ '${correctAnswer}' ì…ë‹ˆë‹¤.`;
                ui.feedbackText.style.color = '#ef4444';
            }
            ui.nextQuestionButton.classList.remove('hidden');
            saveProgress();
        }

        function nextStep() {
            currentQuestionIndex++;
            if (currentQuestionIndex < stageQuestions.length) {
                showQuestion();
            } else {
                showStageResult();
            }
        }

        function showStageResult() {
            ui.quizScreen.classList.add('hidden');
            ui.resultScreen.classList.remove('hidden');
            
            ui.resultTitle.textContent = `${currentStage}ë‹¨ê³„ ê²°ê³¼`;
            ui.finalScoreText.textContent = `${stageScore} / ${stageQuestions.length}`;
            
            const accuracy = (stageScore / stageQuestions.length) * 100;
            if (accuracy === 100) {
                 ui.resultMessage.textContent = "ì™„ë²½í•´ìš”! ì´ ë‹¨ê³„ì˜ ì–´íœ˜ë¥¼ ëª¨ë‘ ì•Œê³  ìˆë„¤ìš”.";
            } else if (accuracy >= 60) {
                 ui.resultMessage.textContent = "ì˜í–ˆì–´ìš”. ë‹¤ìŒ ë‹¨ê³„ë¡œ ë„˜ì–´ê°€ ë´…ì‹œë‹¤!";
            } else {
                 ui.resultMessage.textContent = "ì¡°ê¸ˆ ë” ë…¸ë ¥ì´ í•„ìš”í•´ìš”. ë‹¤ì‹œ ë³µìŠµí•´ ë³´ì„¸ìš”.";
            }
            
            if (currentStage < totalStages) {
                ui.nextStageButton.classList.remove('hidden');
                ui.restartButton.classList.add('hidden');
                ui.captureButton.classList.add('hidden');
            } else {
                showFinalResult();
            }
        }
        
        function nextStage() {
            currentStage++;
            saveProgress();
            ui.resultScreen.classList.add('hidden');
            ui.quizScreen.classList.remove('hidden');
            loadStage();
        }
        
        function showFinalResult() {
             ui.resultTitle.textContent = "ìµœì¢… í•™ìŠµ ê²°ê³¼";
             const totalQuestions = quizData.length;
             ui.finalScoreText.textContent = `${totalScore} / ${totalQuestions}`;
             
             const accuracy = (totalScore / totalQuestions) * 100;
             if (accuracy > 80) {
                 ui.resultMessage.textContent = "í›Œë¥­í•´ìš”! ì–´íœ˜ë¥¼ ì™„ë²½í•˜ê²Œ ì´í•´í•˜ê³  ìˆë„¤ìš”.";
             } else if (accuracy > 50) {
                 ui.resultMessage.textContent = "ì˜í–ˆì–´ìš”! ì¡°ê¸ˆë§Œ ë” ë³µìŠµí•˜ë©´ ì™„ë²½í•´ì§ˆ ê±°ì˜ˆìš”.";
             } else {
                 ui.resultMessage.textContent = "ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤. ë‹¤ì‹œ í•œë²ˆ ë³µìŠµí•´ ë³´ëŠ” ê±´ ì–´ë–¨ê¹Œìš”?";
             }

             ui.nextStageButton.classList.add('hidden');
             ui.restartButton.classList.remove('hidden');
             ui.captureButton.classList.remove('hidden');
             resetProgress(); // ìµœì¢… ê²°ê³¼ë¥¼ ë³¸ í›„ì—ëŠ” ê¸°ë¡ ì´ˆê¸°í™”
        }

        function restartQuiz() {
            resetProgress();
            ui.resultScreen.classList.add('hidden');
            ui.startScreen.classList.remove('hidden');
        }

        function captureResult() {
            // ìº¡ì³ ì „ ë²„íŠ¼ ìˆ¨ê¸°ê¸°
            document.getElementById('result-buttons').style.visibility = 'hidden';
            
            html2canvas(document.getElementById('result-screen')).then(canvas => {
                const image = canvas.toDataURL('image/png');
                const link = document.createElement('a');
                link.href = image;
                link.download = 'korean-vocab-result.png';
                link.click();
                
                // ìº¡ì³ í›„ ë²„íŠ¼ ë‹¤ì‹œ ë³´ì´ê¸°
                document.getElementById('result-buttons').style.visibility = 'visible';
            }).catch(err => {
                console.error("ìº¡ì³ ê¸°ëŠ¥ì— ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:", err);
                alert("ê²°ê³¼ë¥¼ ìº¡ì³í•˜ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
                document.getElementById('result-buttons').style.visibility = 'visible';
            });
        }
    </script>
</body>
</html>

