<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>한국어 4A 단계 실전 모의고사</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Noto Sans KR', sans-serif;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        .choice-btn {
            transition: all 0.2s ease;
            border: 2px solid #e5e7eb;
        }
        .choice-btn:hover {
            background-color: #eff6ff;
            border-color: #3b82f6;
        }
        .choice-btn.selected {
            background-color: #dbeafe;
            border-color: #2563eb;
            color: #1e40af;
            font-weight: bold;
            box-shadow: 0 0 0 2px #bfdbfe;
        }

        .fade-in { animation: fadeIn 0.3s ease-out forwards; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 min-h-screen flex flex-col items-center justify-center" oncontextmenu="return false" oncopy="return false" oncut="return false" onpaste="return false">

    <!-- 보안 경고 -->
    <div id="security-toast" class="fixed top-5 left-1/2 transform -translate-x-1/2 bg-slate-800 text-white px-6 py-3 rounded-full shadow-lg z-50 opacity-0 transition-opacity duration-300 pointer-events-none text-sm font-medium">
        🚫 보안상 복사가 금지되어 있습니다.
    </div>

    <div class="w-full max-w-3xl bg-white shadow-xl rounded-2xl overflow-hidden min-h-[700px] flex flex-col relative">
        
        <!-- 헤더 -->
        <div id="header" class="bg-white border-b px-6 py-4 flex justify-between items-center sticky top-0 z-10 hidden">
            <div class="font-bold text-lg text-slate-700">4A 단계 기말 평가</div>
            <div class="text-sm font-medium bg-slate-100 px-3 py-1 rounded-full text-slate-600">
                <span id="current-num">1</span> / <span id="total-num">25</span>
            </div>
        </div>

        <!-- 메인 -->
        <main class="flex-grow p-6 flex flex-col justify-center relative">
            
            <!-- 시작 화면 -->
            <div id="start-screen" class="text-center space-y-6 fade-in">
                <div class="mb-8">
                    <div class="inline-block bg-indigo-100 text-indigo-600 px-4 py-1 rounded-full font-bold text-sm mb-4">4A 과정</div>
                    <h1 class="text-3xl font-bold text-slate-900 mb-2">한국어 종합 평가 (기말)</h1>
                    <p class="text-slate-500">총 25문항 | 어휘·문법·읽기</p>
                </div>
                
                <div class="space-y-4 max-w-sm mx-auto text-left text-sm bg-slate-50 p-6 rounded-xl border border-slate-200">
                    <p class="flex items-center"><span class="text-indigo-500 mr-2">●</span> 어휘 및 문법 (1~15번)</p>
                    <p class="flex items-center"><span class="text-indigo-500 mr-2">●</span> 읽기 및 이해 (16~25번)</p>
                    <p class="flex items-center"><span class="text-indigo-500 mr-2">●</span> 실전과 유사한 변형 문제</p>
                </div>

                <button onclick="startQuiz()" class="w-full max-w-xs bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-8 rounded-xl transition transform active:scale-95 shadow-lg text-lg">
                    시험 시작하기
                </button>
            </div>

            <!-- 문제 화면 -->
            <div id="quiz-screen" class="hidden flex flex-col h-full">
                <div id="question-container" class="flex-grow overflow-y-auto custom-scrollbar pb-4">
                    <!-- JS로 문제 렌더링 -->
                </div>

                <div class="mt-4 flex justify-between items-center pt-4 border-t bg-white">
                    <button onclick="prevQuestion()" id="prev-btn" class="px-5 py-2 rounded-lg text-slate-500 hover:bg-slate-100 disabled:opacity-30 transition font-medium" disabled>
                        이전
                    </button>
                    <button onclick="nextQuestion()" id="next-btn" class="px-8 py-2.5 rounded-lg bg-indigo-600 hover:bg-indigo-700 text-white shadow-md transition font-bold">
                        다음
                    </button>
                </div>
            </div>

            <!-- 결과 화면 -->
            <div id="result-screen" class="hidden text-center space-y-6 fade-in py-10">
                <h2 class="text-2xl font-bold text-slate-800">평가 결과</h2>
                
                <div class="relative inline-block">
                    <svg class="w-40 h-40 mx-auto transform -rotate-90">
                        <circle class="text-slate-100" stroke-width="12" stroke="currentColor" fill="transparent" r="70" cx="80" cy="80" />
                        <circle id="score-circle" class="text-indigo-500 transition-all duration-1000 ease-out" stroke-width="12" stroke-dasharray="440" stroke-dashoffset="440" stroke-linecap="round" stroke="currentColor" fill="transparent" r="70" cx="80" cy="80" />
                    </svg>
                    <div class="absolute top-0 left-0 w-full h-full flex items-center justify-center flex-col">
                        <span id="score-text" class="text-4xl font-bold text-slate-800">0</span>
                        <span class="text-xs text-slate-500 uppercase font-bold">점</span>
                    </div>
                </div>

                <p id="feedback-text" class="text-lg font-medium text-slate-600"></p>

                <div class="flex justify-center space-x-3 pt-4">
                    <button onclick="showReview()" class="bg-white border border-slate-300 text-slate-700 px-6 py-3 rounded-lg hover:bg-slate-50 font-medium transition">
                        오답 노트
                    </button>
                    <button onclick="location.reload()" class="bg-indigo-600 text-white px-6 py-3 rounded-lg hover:bg-indigo-700 font-bold shadow transition">
                        다시 풀기
                    </button>
                </div>
            </div>

            <!-- 오답 노트 -->
            <div id="review-screen" class="hidden h-full flex flex-col">
                <h3 class="text-xl font-bold mb-4 pb-4 border-b flex justify-between items-center">
                    <span>오답 확인</span>
                    <button onclick="backToResult()" class="text-sm text-indigo-600 hover:underline font-normal">결과로 돌아가기</button>
                </h3>
                <div id="review-list" class="flex-grow overflow-y-auto space-y-6 pr-2 no-scrollbar">
                    <!-- JS 로딩 -->
                </div>
            </div>

        </main>
    </div>

    <script>
        // 보안: 키보드 단축키 차단
        document.addEventListener('keydown', function(e) {
            if ((e.ctrlKey || e.metaKey) && (e.key === 's' || e.key === 'p' || e.key === 'u' || e.key === 'a')) {
                e.preventDefault();
                showSecurityToast();
            }
            if (e.key === 'F12') e.preventDefault();
        });
        document.addEventListener('dragstart', e => e.preventDefault());

        function showSecurityToast() {
            const toast = document.getElementById('security-toast');
            toast.classList.remove('opacity-0');
            setTimeout(() => toast.classList.add('opacity-0'), 2000);
        }

        // --- 문제 데이터 (원본 문제를 바탕으로 변형) ---
        const quizData = [
            // 1~5: 어휘 및 문맥 (Fill in the blank)
            {
                id: 1,
                instruction: "[1~5] 다음 ( &nbsp; )에 들어갈 가장 알맞은 것을 고르십시오.",
                text: "가: 얼굴이 왜 그렇게 어두워요? 무슨 일 있어요?<br>나: 사실은 해결해야 할 ( &nbsp;&nbsp;&nbsp;&nbsp; )가 좀 있어요.",
                choices: ["볼거리", "걱정거리", "먹을거리", "놀거리"],
                answer: 1
            },
            {
                id: 2,
                instruction: "[1~5] 다음 ( &nbsp; )에 들어갈 가장 알맞은 것을 고르십시오.",
                text: "가: 굶주린 아이를 위해 빵을 훔친 사람의 사연을 들었어요.<br>나: 그런 사정을 알면 누구도 그 사람에게 ( &nbsp;&nbsp;&nbsp;&nbsp; )할 수 없을 거예요.",
                choices: ["가위질", "도둑질", "손가락질", "부채질"],
                answer: 2
            },
            {
                id: 3,
                instruction: "[1~5] 다음 ( &nbsp; )에 들어갈 가장 알맞은 것을 고르십시오.",
                text: "가: 이번에 개봉한 영화 제목이 '시간을 달리는 거북이'래요.<br>나: 참 ( &nbsp;&nbsp;&nbsp;&nbsp; ) 제목이네요. 호기심이 생겨요.",
                choices: ["평범한", "지루한", "흥미로운", "심각한"],
                answer: 2
            },
            {
                id: 4,
                instruction: "[1~5] 다음 ( &nbsp; )에 들어갈 가장 알맞은 것을 고르십시오.",
                text: "가: 어제 서점에서 ( &nbsp;&nbsp;&nbsp;&nbsp; ) 고등학교 때 선생님을 뵈었어.<br>나: 정말? 미리 약속도 안 했는데 신기하다.",
                choices: ["우연히", "일부러", "마침내", "당연히"],
                answer: 0
            },
            {
                id: 5,
                instruction: "[1~5] 다음 ( &nbsp; )에 들어갈 가장 알맞은 것을 고르십시오.",
                text: "가: 한국은 김치 종류가 정말 다양하네요.<br>나: 네, 기후와 특산물에 따라 ( &nbsp;&nbsp;&nbsp;&nbsp; )로 맛과 재료가 달라요.",
                choices: ["직업별", "나이별", "성별", "지역별"],
                answer: 3
            },
            // 6~8: 유의어 (Similar Meaning)
            {
                id: 6,
                instruction: "[6~8] 밑줄 친 부분과 의미가 가장 비슷한 것을 고르십시오.",
                text: "열심히 준비한 발표였는데 결과가 <span class='underline font-bold text-indigo-600'>기대만 못해서</span> 속상하다.",
                choices: ["기대보다 좋지 않아서", "기대 이상이라서", "기대했던 대로여서", "기대를 안 해서"],
                answer: 0
            },
            {
                id: 7,
                instruction: "[6~8] 밑줄 친 부분과 의미가 가장 비슷한 것을 고르십시오.",
                text: "세계 여러 나라의 언어는 다르지만, 문법 구조를 살펴보면 <span class='underline font-bold text-indigo-600'>공통점이 있다</span>.",
                choices: ["차이가 크다", "비슷한 점이 있다", "변화가 없다", "이해하기 어렵다"],
                answer: 1
            },
            {
                id: 8,
                instruction: "[6~8] 밑줄 친 부분과 의미가 가장 비슷한 것을 고르십시오.",
                text: "공공장소에서 크게 떠들면서도 미안해하지 않는 걸 보니 <span class='underline font-bold text-indigo-600'>양심이 없는</span> 사람 같다.",
                choices: ["자신감이 없는", "염치가 없는", "관심이 없는", "눈치가 빠른"],
                answer: 1
            },
            // 9~11: 문법 (Grammar)
            {
                id: 9,
                instruction: "[9~11] 다음 ( &nbsp; )에 들어갈 가장 알맞은 것을 고르십시오.",
                text: "택시를 타지 않았더라면 기차를 ( &nbsp;&nbsp;&nbsp;&nbsp; ). 정말 다행이야.",
                choices: ["놓칠 뻔했어", "놓치나 마나야", "놓쳤을 리가 없어", "놓치고 말 거야"],
                answer: 0
            },
            {
                id: 10,
                instruction: "[9~11] 다음 ( &nbsp; )에 들어갈 가장 알맞은 것을 고르십시오.",
                text: "요즘 민수 씨는 취업 준비 때문에 여간 ( &nbsp;&nbsp;&nbsp;&nbsp; ).",
                choices: ["바쁜 척한다", "바쁘지 않다", "바쁜 것이 아니다", "바쁠 테니까"],
                answer: 2
            },
            {
                id: 11,
                instruction: "[9~11] 다음 ( &nbsp; )에 들어갈 가장 알맞은 것을 고르십시오.",
                text: "상자 안에 무엇이 들었는지 겉으로 봐서는 ( &nbsp;&nbsp;&nbsp;&nbsp; ).",
                choices: ["알 수밖에 없다", "알 만하다", "알 수가 없다", "알 정도로 쉽다"],
                answer: 2
            },
            // 12~15: 문법/표현 (Connectives)
            {
                id: 12,
                instruction: "[12~15] 다음 ( &nbsp; )에 들어갈 가장 알맞은 것을 고르십시오.",
                text: "너무 피곤해서 화장을 ( &nbsp;&nbsp;&nbsp;&nbsp; ) 잠이 들었다.",
                choices: ["지우지 않은 채로", "지우지 않으려면", "지웠다가", "지우고서"],
                answer: 0
            },
            {
                id: 13,
                instruction: "[12~15] 다음 ( &nbsp; )에 들어갈 가장 알맞은 것을 고르십시오.",
                text: "가: 이 식당에 왜 이렇게 사람이 많아요?<br>나: 여기가 맛집이라는 ( &nbsp;&nbsp;&nbsp;&nbsp; ) 소문이 났거든요.",
                choices: ["많아서", "많다는", "많자면", "많은데"],
                answer: 1
            },
            {
                id: 14,
                instruction: "[12~15] 다음 ( &nbsp; )에 들어갈 가장 알맞은 것을 고르십시오.",
                text: "가: 지수 씨가 오늘 말을 한마디도 안 하네요.<br>나: 무슨 안 좋은 일이 ( &nbsp;&nbsp;&nbsp;&nbsp; ).",
                choices: ["있는가 봐요", "있기는요", "있을 뿐이에요", "있기 마련이에요"],
                answer: 0
            },
            {
                id: 15,
                instruction: "[12~15] 다음 ( &nbsp; )에 들어갈 가장 알맞은 것을 고르십시오.",
                text: "가: 일이 생각보다 복잡해서 포기하고 싶어요.<br>나: 지금 ( &nbsp;&nbsp;&nbsp;&nbsp; ) 조금만 더 참으면 좋은 결과가 있을 거예요.",
                choices: ["힘들더라도", "힘들어서", "힘들어야", "힘들거든"],
                answer: 0
            },
            // 16: 주제 찾기
            {
                id: 16,
                instruction: "[16] 다음은 무엇에 대한 글인지 고르십시오.",
                passage: "한국에서는 아기가 태어난 지 1년이 되면 '돌잔치'를 한다. 이때 아기가 앞으로 어떻게 살지를 점쳐 보는 '돌잡이'를 하는데, 이것은 오랫동안 이어져 온 한국의 풍습이다.",
                choices: ["예절", "전통", "교육", "성격"],
                answer: 1
            },
            // 17: 내용 일치
            {
                id: 17,
                instruction: "[17] 다음 글의 내용과 같은 것을 고르십시오.",
                passage: "얼마 전 퓨전 국악 공연을 보러 갔다. 판소리에 현대적인 밴드 음악을 더한 공연이었는데 아주 신선했다. 특히 마지막에 부른 '사랑가'는 슬프면서도 아름다웠다. 판소리는 한국의 전통 노래로 소리꾼 한 명이 북 치는 사람의 장단에 맞춰 긴 이야기를 노래로 들려주는 예술이다. 2003년에 유네스코 인류 무형 문화 유산으로 지정되었다.",
                choices: ["판소리는 여러 명이 합창을 하는 노래이다.", "판소리는 아직 유네스코 유산이 아니다.", "공연에서 부른 마지막 곡은 신나는 곡이었다.", "전통 판소리에 현대 음악을 합친 공연을 봤다."],
                answer: 3
            },
            // 18: 제목 이해
            {
                id: 18,
                instruction: "[18] 다음 신문 기사 제목을 가장 잘 설명한 것을 고르십시오.",
                text: "<div class='bg-slate-100 p-3 text-center font-bold border border-slate-300 rounded mb-2'>일회용품 사용 규제, 시민들 불편 호소하며 논란 될 듯</div>",
                choices: ["시민들이 규제를 아주 환영하고 있다.", "일회용품 사용이 줄어들어 거리가 깨끗하다.", "규제 때문에 앞으로 문제가 생길 것 같다.", "시민들의 의견을 모아 규제를 만들었다."],
                answer: 2
            },
            // 19: 순서 배열
            {
                id: 19,
                instruction: "[19] 다음을 순서에 맞게 배열한 것을 고르십시오.",
                text: "(가) 그 결과 쓰레기 무단 투기가 많이 줄어들었다.<br>(나) 깨끗한 거리를 만들기 위해 더 많은 노력을 할 계획이다.<br>(다) 얼마 전부터 쓰레기를 몰래 버리면 과태료를 내게 했다.<br>(라) 또한 거리가 냄새도 안 나고 쾌적해지는 효과도 있다.",
                choices: ["(다)-(가)-(라)-(나)", "(다)-(라)-(가)-(나)", "(가)-(다)-(라)-(나)", "(가)-(라)-(다)-(나)"],
                answer: 0
            },
            // 20: 문맥 채우기
            {
                id: 20,
                instruction: "[20] 다음 글의 ( &nbsp; )에 들어갈 알맞은 것을 고르십시오.",
                passage: "도시 아이들과 시골 아이들이 서로의 생활을 바꿔 경험해 보는 캠프가 열렸다. 도시 아이들은 시골의 불편한 화장실과 벌레 때문에 걱정하며 약과 용품을 잔뜩 챙겼다. 반면 시골 아이들은 도시 생활이 편할 것이라 생각하고 아무런 준비 없이 왔다. 그러나 예상과 달리 시골로 간 아이들은 자연 속에서 즐겁게 지냈지만, 도시로 온 아이들은 ( &nbsp;&nbsp;&nbsp;&nbsp; ).",
                choices: ["시골 생활을 그리워하며 눈물을 흘렸다", "복잡한 교통과 소음 때문에 적응하느라 힘들었다", "준비해 온 물건 덕분에 편안하게 지냈다", "편리한 시설 덕분에 시간 가는 줄 몰랐다"],
                answer: 1
            },
            // 21: 문장 삽입
            {
                id: 21,
                instruction: "[21] 다음 글에서 [보기]의 문장이 들어가기에 가장 알맞은 곳을 고르십시오.",
                passage: "한국의 장례 문화는 시대에 따라 많이 변했다. ( ① ) 예전에는 집에서 장례를 치르고 상복으로 하얀 옷을 입었다. ( ② ) 하지만 요즘은 대부분 병원 장례식장을 이용하고 검은색 양복을 입는다. ( ③ ) 그럼에도 불구하고 문상객을 맞이하고 음식을 대접하는 정성은 여전하다. ( ④ )",
                text: "<div class='bg-indigo-50 p-2 rounded border border-indigo-200 text-sm mb-2'>[보기] 장례를 치르는 장소와 복장이 바뀐 것이 가장 큰 변화이다.</div>",
                choices: ["①", "②", "③", "④"],
                answer: 1
            },
            // 22: 주제 고르기
            {
                id: 22,
                instruction: "[22] 다음 글의 주제로 가장 알맞은 것을 고르십시오.",
                passage: "우리는 식당에서 종업원을 부를 때 큰 소리로 부르거나 벨을 누른다. 한국에서는 이것이 자연스러운 일이지만, 서양에서는 무례한 행동으로 보일 수 있다. 서양에서는 종업원이 올 때까지 눈을 맞추며 조용히 기다리는 것이 예절이다. 문화는 나라마다 다르므로 나의 기준만으로 다른 문화를 평가해서는 안 된다.",
                choices: ["식당에서는 종업원을 부르지 말아야 한다.", "한국의 식당 예절이 서양보다 더 편리하다.", "문화적 차이를 인정하고 존중해야 한다.", "해외여행을 갈 때는 식사 예절을 배워야 한다."],
                answer: 2
            },
            // 23~25: 읽기 (지문 변형 - 모소족 유사 사례)
            {
                id: 23,
                instruction: "[23~25] 다음을 읽고 질문에 답하십시오. (1/3)",
                passage: "현대 사회는 보통 아버지가 가장이 되거나 부모가 함께 가정을 이끈다. 그러나 이와 다른 방식으로 살아가는 사람들도 있다. 인도네시아의 '미낭카바우' 족이 대표적이다. 이들은 세계에서 가장 큰 모계 사회 중 하나이다.<br><br>미낭카바우 족은 어머니를 중심으로 가족이 구성된다. 집안의 재산과 땅은 딸에게만 물려주며, 어머니의 성을 따른다. 결혼을 해도 남자는 아내의 집에 들어와 살지만, 아침이 되면 자신의 어머니 집으로 돌아가 일을 하기도 한다. 남자는 자녀 양육에 대한 책임보다는 자신의 여자 형제(누이)의 아이들을 돌볼 의무가 더 크다.<br><br>이처럼 미낭카바우 족은 그들만의 독특한 전통을 지켜왔다. 하지만 최근 도시화와 현대 사회의 ( ㉠ ) 인해 이러한 전통적인 가족 형태도 조금씩 변화하고 있다.",
                text: "<b>23. 미낭카바우 족의 특징으로 맞지 <u>않는</u> 것은?</b>",
                choices: ["재산은 딸이 물려받는다.", "아버지가 집안의 가장이 된다.", "가족은 어머니를 중심으로 산다.", "자녀는 어머니의 성을 따른다."],
                answer: 1
            },
            {
                id: 24,
                instruction: "[23~25] 다음을 읽고 질문에 답하십시오. (2/3)",
                passage: "(지문은 위와 동일합니다)",
                text: "<b>24. ( ㉠ )에 들어갈 내용으로 알맞은 것은?</b>",
                choices: ["영향을 받아", "도움을 받아", "허락을 받아", "존중을 받아"],
                answer: 0
            },
            {
                id: 25,
                instruction: "[23~25] 다음을 읽고 질문에 답하십시오. (3/3)",
                passage: "(지문은 위와 동일합니다)",
                text: "<b>25. 이 글의 내용과 같은 것은?</b>",
                choices: ["남자는 결혼하면 아내의 집에서 영원히 나오지 않는다.", "남자는 자기 자식보다 누이의 자식을 돌볼 의무가 크다.", "최근에는 전통이 더욱 강해져서 변화가 없다.", "이 부족은 아버지의 성을 따르는 전통이 있다."],
                answer: 1
            }
        ];

        let currentIdx = 0;
        let userAnswers = new Array(quizData.length).fill(null);

        function startQuiz() {
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            document.getElementById('header').classList.remove('hidden');
            renderQuestion();
        }

        function renderQuestion() {
            const q = quizData[currentIdx];
            const container = document.getElementById('question-container');
            
            document.getElementById('current-num').innerText = currentIdx + 1;
            document.getElementById('prev-btn').disabled = (currentIdx === 0);
            document.getElementById('next-btn').innerText = (currentIdx === quizData.length - 1) ? "결과 확인" : "다음";

            let html = `
                <div class="space-y-6 fade-in">
                    <div>
                        <p class="text-sm font-bold text-indigo-600 mb-1">${q.instruction}</p>
            `;

            if (q.passage) {
                html += `<div class="bg-slate-50 p-5 rounded-xl border border-slate-200 text-slate-700 leading-relaxed text-sm mb-4 break-keep">${q.passage}</div>`;
            }

            if (q.text) {
                html += `<div class="text-lg font-medium text-slate-800 mb-2 break-keep">${q.text}</div>`;
            }

            html += `</div><div class="grid grid-cols-1 gap-3">`;
            
            q.choices.forEach((choice, i) => {
                const isSelected = userAnswers[currentIdx] === i ? "selected" : "";
                html += `
                    <button onclick="selectChoice(${i})" class="choice-btn w-full text-left px-5 py-4 rounded-xl bg-white flex items-center group ${isSelected}">
                        <span class="w-8 h-8 rounded-full bg-slate-100 text-slate-500 flex items-center justify-center mr-4 text-sm font-bold group-hover:bg-indigo-100 group-hover:text-indigo-600 transition-colors ${isSelected ? '!bg-indigo-600 !text-white' : ''}">
                            ${i + 1}
                        </span>
                        <span class="text-slate-700 font-medium group-hover:text-slate-900 ${isSelected ? '!text-indigo-800' : ''}">${choice}</span>
                    </button>
                `;
            });
            html += `</div></div>`;

            container.innerHTML = html;
            container.scrollTop = 0;
        }

        function selectChoice(index) {
            userAnswers[currentIdx] = index;
            renderQuestion();
        }

        function nextQuestion() {
            if (currentIdx < quizData.length - 1) {
                currentIdx++;
                renderQuestion();
            } else {
                finishQuiz();
            }
        }

        function prevQuestion() {
            if (currentIdx > 0) {
                currentIdx--;
                renderQuestion();
            }
        }

        function finishQuiz() {
            document.getElementById('header').classList.add('hidden');
            document.getElementById('quiz-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');

            let correctCount = 0;
            quizData.forEach((q, i) => {
                if (userAnswers[i] === q.answer) correctCount++;
            });
            
            const score = Math.round((correctCount / quizData.length) * 100);
            
            // 점수 애니메이션
            const circle = document.getElementById('score-circle');
            const radius = circle.r.baseVal.value;
            const circumference = radius * 2 * Math.PI;
            const offset = circumference - (score / 100) * circumference;
            
            setTimeout(() => {
                circle.style.strokeDashoffset = offset;
                animateValue("score-text", 0, score, 1000);
            }, 100);

            const feedback = document.getElementById('feedback-text');
            if (score >= 90) feedback.innerHTML = "탁월한 실력입니다! <br>4A 과정을 완벽히 이해하셨네요.";
            else if (score >= 70) feedback.innerHTML = "잘하셨습니다! <br>합격권입니다.";
            else if (score >= 50) feedback.innerHTML = "수고하셨습니다. <br>오답 노트를 꼭 확인해보세요.";
            else feedback.innerHTML = "조금 더 노력이 필요합니다. <br>다시 한 번 복습해 봅시다.";
        }

        function animateValue(id, start, end, duration) {
            let range = end - start;
            let current = start;
            let increment = end > start ? 1 : -1;
            let stepTime = Math.abs(Math.floor(duration / range));
            let obj = document.getElementById(id);
            let timer = setInterval(() => {
                current += increment;
                obj.innerHTML = current;
                if (current == end) clearInterval(timer);
            }, stepTime);
        }

        function showReview() {
            document.getElementById('result-screen').classList.add('hidden');
            document.getElementById('review-screen').classList.remove('hidden');
            
            const list = document.getElementById('review-list');
            list.innerHTML = "";

            let hasWrong = false;
            quizData.forEach((q, i) => {
                if (userAnswers[i] !== q.answer) {
                    hasWrong = true;
                    const myAns = userAnswers[i] !== null ? q.choices[userAnswers[i]] : "선택 안 함";
                    const correctAns = q.choices[q.answer];
                    const qText = q.passage ? "(지문 내용 생략)" : q.text.replace(/<[^>]*>?/gm, '');

                    list.innerHTML += `
                        <div class="bg-red-50 p-5 rounded-xl border border-red-100 text-sm">
                            <div class="flex justify-between mb-2">
                                <span class="font-bold text-red-600">문제 ${i + 1}</span>
                            </div>
                            <p class="text-slate-700 mb-3 font-medium">${qText}</p>
                            <div class="grid grid-cols-2 gap-4 bg-white p-3 rounded-lg">
                                <div>
                                    <span class="text-xs text-slate-400 block mb-1">내 답안</span>
                                    <span class="font-bold text-red-500">${myAns}</span>
                                </div>
                                <div>
                                    <span class="text-xs text-slate-400 block mb-1">정답</span>
                                    <span class="font-bold text-indigo-600">${correctAns}</span>
                                </div>
                            </div>
                        </div>
                    `;
                }
            });

            if (!hasWrong) {
                list.innerHTML = `
                    <div class="flex flex-col items-center justify-center h-64 text-center text-slate-500">
                        <p class="text-lg font-medium">틀린 문제가 없습니다.</p>
                        <p>완벽합니다! 🎉</p>
                    </div>
                `;
            }
        }

        function backToResult() {
            document.getElementById('review-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
        }
    </script>
</body>
</html>


